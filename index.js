const name="Database";let main=null;try{main=window??self}catch(e){main=global}async function Exporter(e,...t){var n=(await import("node:module"))["createRequire"],n=n("file:///"+(await import("path")).resolve(".").replaceAll("\\","/")),r={exports:{}};return e(r,r.exports,n),r.exports[t[0]](...t.slice(1))}Object.defineProperty(main,name,{writable:!1,configurable:!1,enumerable:!1,value:function(...e){return Exporter(function(e,t,n){"use strict";function r(e,t,n,r){if(t&&"object"==typeof t||"function"==typeof t)for(var a,o=f(t),i=0,u=o.length;i<u;i++)a=o[i],s.call(e,a)||a===n||c(e,a,{get:(function(e){return t[e]}).bind(null,a),enumerable:!(r=l(t,a))||r.enumerable});return e}function a(e,t,n){return n=null!=e?i(u(e)):{},r(!t&&e&&e.__esModule?n:c(n,"default",{value:e,enumerable:!0}),e)}var o,i=Object.create,c=Object.defineProperty,l=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,u=Object.getPrototypeOf,s=Object.prototype.hasOwnProperty,d={},v=d,p={ForceHistoryCleanUp:function(){return O},ForceHistoryCleanUpForEach:function(){return b},Get:function(){return S},Latest:function(){return y},Set:function(){return B}};for(o in p)c(v,o,{get:p[o],enumerable:!0});e.exports=(e=d,r(c({},"__esModule",{value:!0}),e));function m(e){e=e.replace(/(\/)$/,"");var t=[];return g.default.readdirSync(e).forEach(function(e){t.push(e)}),t}function D(e){try{return g.default.readFileSync(e,"utf8")}catch(e){}}var h=a(n("fs"),1),g=a(n("fs"),1),w=a(n("process"),1),y=function(){var t,n,r,a,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"*",o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,u=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"id";if(w.default.env&&w.default.env.DB)return"*"==e?(t={},m(w.default.env.DB).map(function(e){t[e]=y(e,o,i,u)}),t):Array.isArray(e)?(n={},e.map(function(e){n[e]=y(e,o,i,u)}),n):(r=[],a=[],S(e,o,i).map(function(e){var t=e.data[u],n=a.indexOf(t);-1==n?(a.push(t),r.push(e)):r[n].timestamp<e.timestamp&&(r[n]=e)}),r);throw new Error("process.env.DB is not defined")},b=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"id";if(!w.default.env||!w.default.env.DB)throw new Error("process.env.DB is not defined");m(w.default.env.DB).map(function(e){return O(e,t)})},O=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"id";if(!w.default.env||!w.default.env.DB)throw new Error("process.env.DB is not defined");var e=y(t,{},null,e),n="".concat(w.default.env.DB,"/").concat(t);if(!process.env||!process.env.DB)throw new Error("process.env.DB is not defined");h.default.rmSync(n,{recursive:!0,force:!0}),e.map(function(e){return B(t,e.data,e.timestamp)})},B=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!w.default.env||!w.default.env.DB)throw new Error("process.env.DB is not defined");var r,a=null==n?Date.parse((new Date).toISOString()):Date.parse(new Date(parseInt(n)).toISOString());r=(r="".concat(w.default.env.DB,"/").concat(t,"/").concat(a,"/")).toString(),h.default.existsSync(r)||h.default.mkdirSync(r,{recursive:!0});for(var o,i,u=Object.keys(e).map(function(e){return"".concat(w.default.env.DB,"/").concat(t,"/").concat(a,"/")+e}),c=Object.values(e),l=0;l<u.length;l++)o=u[l],i=c[l],h.default.writeFileSync(o,i.toString())},S=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!w.default.env||!w.default.env.DB)throw new Error("process.env.DB is not defined");var r=Date.parse((new Date).toISOString()),a=null==n?0:Date.parse(new Date(r-864e5*n).toISOString()),o=null;try{o=m("".concat(w.default.env.DB,"/").concat(t,"/")).filter(function(e){return a<=+e}).map(function(e){return"".concat(w.default.env.DB,"/").concat(t,"/")+e+"/"})}catch(e){return[]}var r=Object.keys(e),i=Object.values(e);r.map(function(t,n){o=o.filter(function(e){return m(e).includes(t)}).filter(function(e){return D(e+t)==i[n]})});return o.map(function(t){var e=t.split("/"),e=e[e.length-2],n=new Date(parseInt(e)).toGMTString(),r={};m(t).map(function(e){r[e]=D(t+e)});return{timestamp:e,time:n,data:r}}).reverse()}},...e)}});